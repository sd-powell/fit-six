{% load static %}

{# Desktop nav: category links, search, user account, cart icon #}

<!-- Desktop Nav Row -->
<div class="row px-5 py-3 d-none d-lg-flex align-items-center">

<!-- Left: Logo -->
<div class="col-lg-3 text-start">
    <a href="{% url 'home' %}" class="nav-link p-0">
    <img src="{% static 'images/fitsix-logo.svg' %}" alt="Fit Six Logo" height="100">
    </a>
</div>

<!-- Center: Category Navigation (now inline, not absolute) -->
<div class="col-lg-6 d-flex justify-content-center align-items-center">
    <nav aria-label="Product categories">
    <ul class="d-flex justify-content-center align-items-center gap-4 list-unstyled mb-0">
        <li><a href="{% url 'products' %}?category=apparel" class="navlink text-uppercase fs-6">Apparel</a></li>
        <li><a href="{% url 'products' %}?category=supplements" class="navlink text-uppercase fs-6">Supplements</a></li>
        <li><a href="{% url 'products' %}?category=accessories" class="navlink text-uppercase fs-6">Accessories</a></li>
        <li><a href="{% url 'products' %}?category=class_bundles" class="navlink text-uppercase fs-6 text-nowrap">Class Bundles</a></li>
    </ul>
    </nav>
</div>

<!-- Right: Search + Account + Bag -->
<div class="col-lg-3 d-flex justify-content-end align-items-center">
    <ul class="list-inline mb-0 d-flex gap-3 align-items-center">

    <!-- Search Icon -->
    <li class="list-inline-item">
        <a href="#" class="nav-link text-white" id="desktop-search-toggle" aria-label="Open search">
        <i class="fas fa-search fa-lg"></i>
        </a>
    </li>

    <!-- User Dropdown -->
    <li class="list-inline-item dropdown">
        <a class="nav-link text-white" href="#" id="user-options" data-bs-toggle="dropdown" aria-expanded="false">
        <i class="fas fa-user fa-lg"></i>
        </a>
        <ul class="dropdown-menu dropdown-menu-end bg-light border-0" aria-labelledby="user-options">
        {% if request.user.is_authenticated %}
            {% if request.user.is_superuser %}
            <li><a href="{% url 'add_product' %}" class="dropdown-item">Product Management</a></li>
            {% endif %}
            <li><a href="{% url 'profile' %}" class="dropdown-item">My Profile</a></li>
            <li><a href="{% url 'account_logout' %}" class="dropdown-item">Logout</a></li>
        {% else %}
            <li><a href="{% url 'account_signup' %}" class="dropdown-item">Sign up</a></li>
            <li><a href="{% url 'account_login' %}" class="dropdown-item">Sign in</a></li>
        {% endif %}
        </ul>
    </li>

    <!-- Shopping Bag Icon -->
    <li class="list-inline-item">
        <a href="{% url 'view_bag' %}" class="nav-link text-white position-relative">
        <i class="fas fa-shopping-bag fa-lg"></i>
        {% if product_count and product_count > 0 %}
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-primary">
            {{ product_count }}
            </span>
        {% endif %}
        </a>
    </li>

    </ul>
</div>
</div>

<!-- Desktop Slide-In Search (Toggleable) -->
<div id="desktop-search-bar" class="container-fluid bg-light d-none position-absolute top-100 start-0 end-0 z-3 shadow py-2">
    <div class="container">
        <form method="GET" action="{% url 'products' %}" role="search" aria-label="Sitewide product search">
        <div class="input-group align-items-center">
            <!-- Close icon on the left -->
            <span class="me-2 close-desktop-search" role="button" aria-label="Close search" title="Close search"
                style="cursor: pointer; font-size: 1.5rem;">
            &times;
            </span>

            <!-- Search input -->
            <input type="text" name="q" class="form-control rounded-start-pill text-uppercase"
                placeholder="Search our site" aria-label="Search query">
            
            <!-- Submit button -->
            <button type="submit" class="btn btn-dark rounded-0 rounded-end" aria-label="Submit search">
            <i class="fas fa-search"></i>
            </button>
        </div>
        </form>
    </div>
</div>